import{d as he,r as c,J as de,k as ge,o as ve,K as pe,x as m,z as w,L as $,M as A,N as G,O as P,A as ee,P as te,y as R}from"./BvIQ4i6F.js";import{_ as me}from"./DlAUqK2U.js";const we={class:"score-display"},Re={key:0},ye={key:1},oe=800,g=400,i=50,T=50,ae=50,I=10,ne=25,j=500,Ye=1,H=1100,se=2300,Xe=2,xe=400;var u=(s=>(s[s.SingleLow=0]="SingleLow",s[s.SingleHigh=1]="SingleHigh",s[s.TallWall=2]="TallWall",s[s.FloatingIsland=3]="FloatingIsland",s[s.UnevenGround=4]="UnevenGround",s[s.VeryHighTrap=5]="VeryHighTrap",s))(u||{});const _=100,Oe=he({__name:"index",setup(s){const N=c(5);let F=0,b=0;const x={0:{parts:[{offsetX:0,offsetY:0,widthRange:[30,80],heightRange:[25,50],colorOptions:["#CD853F","#D2691E"]}],baseTotalWidth:50,baseTotalHeight:40,spawnWeight:30},1:{parts:[{offsetX:0,offsetY:0,widthRange:[25,60],heightRange:[40,70],colorOptions:["#A0522D","#8B4513"]}],baseTotalWidth:40,baseTotalHeight:60,canBeFloating:!0,minYOffset:T*.4,maxYOffset:T*1.5,spawnWeight:25},2:{parts:[{offsetX:0,offsetY:0,widthRange:[40,70],heightRange:[g*.4-i,g*.8-i],colorOptions:["#696969"]}],baseTotalWidth:55,baseTotalHeight:g*.7-i,spawnWeight:15},3:{parts:[{offsetX:0,offsetY:0,widthRange:[80,150],heightRange:[30,50],colorOptions:["#8FBC8F"]},{offsetX:10,offsetY:-15,widthRange:[60,120],heightRange:[15,25],colorOptions:["#2E8B57"]}],baseTotalWidth:120,baseTotalHeight:60,canBeFloating:!0,minYOffset:T*.8,maxYOffset:g*.5,spawnWeight:10},4:{parts:[{offsetX:0,offsetY:0,widthRange:[40,60],heightRange:[15,30],colorOptions:["#BDB76B"]},{offsetX:50,offsetY:0,widthRange:[30,50],heightRange:[25,40],colorOptions:["#F0E68C"]},{offsetX:90,offsetY:0,widthRange:[20,40],heightRange:[10,25],colorOptions:["#BDB76B"]}],baseTotalWidth:120,baseTotalHeight:40,spawnWeight:15},5:{parts:[{offsetX:0,offsetY:0,widthRange:[20,35],heightRange:[20,35],colorOptions:["#FF6347"]}],baseTotalWidth:30,baseTotalHeight:30,canBeFloating:!0,minYOffset:g*.75-i,maxYOffset:g*.85-i,spawnWeight:5}},v=c(i),W=c(0),y=c(!1),r=c(!1);let k=0;const Y=c(0),D=c(0),X=de([]);let U=0;const h=c(!1),l=c(!1);let p=null;const C=c(0),B=ge(()=>({left:_,right:_+ae,top:g-v.value-T,bottom:g-v.value}));function K(t){!y.value&&h.value&&!l.value&&(y.value=!0,W.value=t)}function L(t,a){return Math.random()*(a-t)+t}function le(t){return t[Math.floor(Math.random()*t.length)]}function ie(){const t=Object.values(x).reduce((e,f)=>e+f.spawnWeight,0);let a=Math.random()*t,o=null;for(const e in x){const f=parseInt(e);if(x.hasOwnProperty(f)){if(a<x[f].spawnWeight){o=f;break}a-=x[f].spawnWeight}}o===null&&(console.warn("Fallback to SingleLow as selectedPresetType was null. Check spawnWeights if this is unexpected."),o=0);const n=x[o];if(!n){console.error(`FATAL: Preset for type ${u[o]} (enum value ${o}) is undefined in obstaclePresets. Please check obstaclePresets definition.`);return}let E=i;n.canBeFloating&&n.minYOffset!==void 0&&n.maxYOffset!==void 0&&(E=i+L(n.minYOffset,n.maxYOffset)),console.log(`Attempting to spawn preset: ${u[o]}`);const Z=n.parts.map((e,f)=>{if(!e)return console.error(`Blueprint at index ${f} for preset ${u[o]} is undefined.`),{offsetX:0,offsetY:0,width:10,height:10,color:"magenta",error:"Undefined blueprint"};if(!e.widthRange||!Array.isArray(e.widthRange)||e.widthRange.length<2)return console.error(`Blueprint ${f} (offsetX: ${e.offsetX}) for preset ${u[o]} has invalid or missing widthRange. Actual value:`,e.widthRange),{offsetX:e.offsetX||0,offsetY:e.offsetY||0,width:10,height:10,color:"purple",error:"Invalid widthRange"};if(!e.heightRange||!Array.isArray(e.heightRange)||e.heightRange.length<2)return console.error(`Blueprint ${f} (offsetX: ${e.offsetX}) for preset ${u[o]} has invalid or missing heightRange. Actual value:`,e.heightRange),{offsetX:e.offsetX||0,offsetY:e.offsetY||0,width:10,height:10,color:"orange",error:"Invalid heightRange"};if(!e.colorOptions||!Array.isArray(e.colorOptions)||e.colorOptions.length===0)return console.error(`Blueprint ${f} (offsetX: ${e.offsetX}) for preset ${u[o]} has invalid or missing colorOptions. Actual value:`,e.colorOptions),{offsetX:e.offsetX||0,offsetY:e.offsetY||0,width:10,height:10,color:"cyan",error:"Invalid colorOptions"};const fe=L(e.widthRange[0],e.widthRange[1]),ce=L(e.heightRange[0],e.heightRange[1]),ue=le(e.colorOptions);return{offsetX:e.offsetX,offsetY:e.offsetY,width:fe,height:ce,color:ue}}),J=Z.filter(e=>!e.hasOwnProperty("error"));if(J.length!==Z.length&&console.warn(`Some parts were invalid and have been filtered out for preset ${u[o]}.`),J.length===0&&n.parts.length>0){console.error(`No valid parts could be generated for preset ${u[o]}. Skipping obstacle spawn.`);return}const V={id:U++,presetType:o,x:oe,y:E,colliderWidth:n.baseTotalWidth,colliderHeight:n.baseTotalHeight,parts:J.map(e=>({renderX:oe+(e.offsetX||0),renderY:E+(e.offsetY||0),width:e.width,height:e.height,color:e.color,offsetX:e.offsetX||0,offsetY:e.offsetY||0}))};V.parts.length>0||n.parts.length===0?(X.push(V),console.log("Spawned Instance:",u[o],V)):n.parts.length>0&&console.warn(`Obstacle instance for ${u[o]} was not pushed because it had no valid parts after filtering.`)}function re(){for(const t of X){const a={left:t.x,right:t.x+t.colliderWidth,top:g-t.y-t.colliderHeight,bottom:g-t.y};if(B.value.left<a.right&&B.value.right>a.left&&B.value.top<a.bottom&&B.value.bottom>a.top)return!0}return!1}function q(t){if(!h.value||l.value){l.value&&p&&(cancelAnimationFrame(p),p=null);return}if(r.value){const a=performance.now()-k;Y.value=Math.min(a/j,1)}else Y.value=0;if(v.value+=W.value,(v.value>i||y.value)&&(W.value-=Ye),v.value<=i&&(v.value=i,W.value=0,y.value=!1),D.value-=N.value,t>=F)if(ie(),b<Xe&&Math.random()<.4)F=t+xe+L(-50,50);else{const a=H+Math.random()*(se-H);F=t+a,b=0}for(let a=X.length-1;a>=0;a--){const o=X[a];o.x-=N.value,o.parts.forEach(n=>{n.renderX=o.x+n.offsetX}),o.x+o.colliderWidth<0&&(X.splice(a,1),l.value||(C.value+=10))}re()&&(l.value=!0,console.log("GAME OVER!")),l.value||(p=requestAnimationFrame(q))}function z(t){t.code==="Space"&&(t.preventDefault(),h.value?!l.value&&!y.value&&!r.value&&(r.value=!0,k=performance.now(),Y.value=0):M())}function Q(t){if(t.code==="Space"&&r.value&&h.value&&!l.value){const a=performance.now()-k;r.value=!1;const o=Math.min(a/j,1),n=I+(ne-I)*o;K(n)}}function O(){h.value?!l.value&&!y.value&&!r.value&&(r.value=!0,k=performance.now(),Y.value=0):M()}function S(){if(r.value&&h.value&&!l.value){const t=performance.now()-k;r.value=!1;const a=Math.min(t/j,1),o=I+(ne-I)*a;K(o)}}function M(){if(h.value&&!l.value)return;h.value=!0,l.value=!1,v.value=i,W.value=0,y.value=!1,r.value=!1,Y.value=0,D.value=0,X.length=0,U=0,b=0,C.value=0;const t=H+Math.random()*(se-H);F=performance.now()+t+500,p&&cancelAnimationFrame(p),p=requestAnimationFrame(q)}const d=c(null);return ve(()=>{window.addEventListener("keydown",z),window.addEventListener("keyup",Q),d.value&&(d.value.addEventListener("mousedown",O),d.value.addEventListener("mouseup",S),d.value.addEventListener("touchstart",O,{passive:!1}),d.value.addEventListener("touchend",S))}),pe(()=>{window.removeEventListener("keydown",z),window.removeEventListener("keyup",Q),d.value&&(d.value.removeEventListener("mousedown",O),d.value.removeEventListener("mouseup",S),d.value.removeEventListener("touchstart",O),d.value.removeEventListener("touchend",S)),p&&cancelAnimationFrame(p)}),(t,a)=>(R(),m("div",{class:"game-container",onMousedown:O,onMouseup:S,onTouchstart:te(O,["prevent"]),onTouchend:S},[w("div",{class:"player",style:A({bottom:v.value+"px",left:_+"px"})},[r.value||Y.value>0?(R(),m("div",{key:0,class:"charge-bar-container",style:A({position:"absolute",left:_-100+"px",bottom:v.value+1+"px",width:ae+"px"})},[w("div",{class:"charge-bar-fill",style:A({width:Y.value*100+"%"})},null,4)],4)):$("",!0)],4),w("div",{class:"ground",style:A({backgroundPositionX:D.value+"px"})},null,4),(R(!0),m(G,null,P(X,o=>(R(),m(G,{key:o.id},[(R(!0),m(G,null,P(o.parts,(n,E)=>(R(),m("div",{key:`${o.id}-${E}`,class:"obstacle-part",style:A({left:n.renderX+"px",bottom:n.renderY+"px",width:n.width+"px",height:n.height+"px",backgroundColor:n.color})},null,4))),128))],64))),128)),w("div",we,"Score: "+ee(C.value),1),!h.value||l.value?(R(),m("div",{key:0,class:"message-overlay",onClick:a[0]||(a[0]=te(()=>{},["stop"]))},[h.value?$("",!0):(R(),m("div",Re,[a[1]||(a[1]=w("h1",null,"Nuxt Runner",-1)),w("button",{onClick:M},"START")])),l.value?(R(),m("div",ye,[a[2]||(a[2]=w("h2",null,"GAME OVER",-1)),w("p",null,"Your Score: "+ee(C.value),1),w("button",{onClick:M},"RETRY")])):$("",!0)])):$("",!0)],32))}}),ke=me(Oe,[["__scopeId","data-v-1d42f2ef"]]);export{ke as default};
